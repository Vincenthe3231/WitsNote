{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Listicle Post</title>
    <link rel="stylesheet" href="{% static 'css/blog-post-alignment.css' %}">
    {% include 'quick-load/load-style.html' %}
</head>

<body id="top">
    {% include 'format/navbar.html' %}
    {% include 'format/header.html' %}
    <main class="container my-5">
        <form method="post" action="{% url 'post_dispatcher' form_type='listicle_blog_post' %}"
            enctype="multipart/form-data">
            <!-- <input type="hidden" name="form_type" value="standard"> -->
            {% csrf_token %}

            {% include 'format/masthead.html' %}

            <section class="mb-4" data-section="introduction">
                <h2 class="fw-normal">Introduction</h2>
                <i class="bi bi-plus" data-input-id="introImageInput" style="cursor:pointer;" title="Add Image"></i>
                <input type="file" name="intro_images" id="introImageInput" accept="image/*" style="display:none;"
                    multiple>
                <div class="imageContainer mt-2 d-flex flex-wrap gap-2"></div>

                <textarea name="introduction" id="introductionText" class="form-control-plaintext" rows="4" required
                    placeholder="This is the introduction to the blog post. It sets the stage for what the reader can expect and introduces the main topic."></textarea>
                <button id="introSummaryBtn" class="btn btn-primary mt-2">✨ Summarize Introduction</button>
                <div id="introSummaryOutput" class="mt-3 generated-output" style="display: none;">
                    <strong>Summary:</strong> <span id="introSummaryText"></span>
                    <div id="introSummaryLoading" class="spinner-border spinner-border-sm text-primary" role="status"
                        style="display: none;">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
                <div class="imageContainer"></div>
            </section>

            <section class="mb-4" data-section="main_content">
                <h2 class="fw-normal">Main Content</h2>

                <!-- Allowing users to add multiple images -->
                <i class="bi bi-plus" data-input-id="mainImageInput" style="cursor:pointer;" title="Add Image"></i>
                <input type="file" name="main_images" id="mainImageInput" accept="image/*" style="display:none;"
                    multiple>
                
                <!-- Container to wrap all the uploaded images -->
                <div class="imageContainer mt-2 d-flex flex-wrap gap-2"></div>

                <!-- Main Content Textarea -->
                <textarea name="main_content" id="mainContentText" class="form-control-plaintext" rows="8" required
                    placeholder="This is the main content of the blog post. It should be detailed and provide all the necessary information, arguments, or stories. For example, if this blog post is about the benefits of remote work, this section would discuss increased flexibility, reduced commute times, access to a global talent pool, and potential cost savings for businesses. It might also touch upon challenges like maintaining team cohesion or ensuring productivity, and how to overcome them. The content here should be substantial enough for summarization and for generating a meaningful conclusion."></textarea>

                <!-- Allowing users to add subheadings -->
                <i class="bi bi-plus" id="addSubHeadingBtn" style="cursor:pointer;" title="Add Subheading"></i>
                <div id="subHeadingContainer" class="mt-3 d-flex flex-column gap-2"></div>

                <!-- AI Summarizer -->
                <!-- <button id="summarizeBtn" class="btn btn-primary mt-2">✨ Summarize Main Content</button>
                <div id="summaryOutput" class="mt-3 generated-output" style="display: none;">
                    <strong>Summary:</strong> <span id="summaryText"></span>
                    <div id="summaryLoading" class="spinner-border spinner-border-sm text-primary" role="status"
                        style="display: none;">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
                <div class="imageContainer"></div> -->
            </section>

            <section class="mb-4" data-section="conclusion">
                <h2 class="fw-normal">Conclusion</h2>
                <i class="bi bi-plus" data-input-id="conclusionImageInput" style="cursor:pointer;"
                    title="Add Image"></i>
                <input type="file" name="conclusion_images" id="conclusionImageInput" accept="image/*"
                    style="display:none;" multiple>
                <div class="imageContainer mt-2 d-flex flex-wrap gap-2"></div>
                <textarea name="conclusion" id="conclusionText" class="form-control-plaintext" rows="4" required
                    placeholder="This is the conclusion of the blog post. It should summarize the key points and offer a final thought or call to action. (Click 'Generate Conclusion' to get a new one!)"></textarea>
                <button id="generateConclusionBtn" class="btn btn-primary mt-2">✨ Generate Conclusion</button>
                <div id="conclusionOutput" class="mt-3 generated-output" style="display: none;">
                    <strong>Generated Conclusion:</strong> <span id="generatedConclusionText"></span>
                    <div id="conclusionLoading" class="spinner-border spinner-border-sm text-primary" role="status"
                        style="display: none;">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
            </section>
            </section>
            <div class="d-flex justify-content-end mt-4">
                <button type="submit" id="createPostBtn" class="btn custom-btn">Create</button>
            </div>
        </form>
    </main>
    </form>
    </main>
    {% include 'format/footer.html' %}
    {% include 'quick-load/load-js.html' %}
    <script>
        window.AppConfig = {
            GEMINI_API_KEY: "{{ gemini_api_key }}",
            GEMINI_API_URL: "{{ gemini_api_url }}"
        };
    </script>
    <script src="{% static 'js/post-customization/listicle-blog-post.js' %}"></script>

    <!-- Fullscreen Image Preview Modal -->
    <div class="modal fade" id="imagePreviewModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content bg-dark text-white">
                <div class="modal-header border-0">
                    <button type="button" class="btn-close btn-close-white ms-auto" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <div class="modal-body d-flex justify-content-center align-items-center">
                    <!-- Preview Image with smooth zoom animation -->
                    <img id="modalPreviewImage" src="" alt="Preview" class="img-fluid"
                        style="max-height: 90vh; transition: transform 0.3s ease; cursor: zoom-in;" />
                </div>
            </div>
        </div>
    </div>
</body>

</html>